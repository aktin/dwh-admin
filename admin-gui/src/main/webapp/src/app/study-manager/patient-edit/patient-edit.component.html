<div id="popup-message-overlay">
</div>

<div class="ui text container very padded segment"
     id="popup-message-content">
    <div class="ui header">
        Patientendaten bearbeiten
    </div>

    <div class="ui content"
         style="padding-bottom: 1em">
        Bitte bearbeiten Sie die Felder, die Sie ändern möchten und speichern dann diese
    </div>

    <div class="close-action">
        <a (click)="close()"
           class="ui compact small icon circular button">
            <i class="remove icon"></i>
        </a>
    </div>

    <div class="ui sixteen wide column form">
        <form ngForm>
            <div class="ui row">
                <div #accordion
                     class="ui styled accordion">
                    <div class="active title">
                        <i class="dropdown icon right"></i>
                        Studieninformationen
                    </div>
                    <div class="active content">
                        <div class="field">
                            <label>Studie</label>
                            <div class="value-field">{{ entry.study.title }}</div>
                        </div>

                        <div class="field">
                            <label>Teilnahme</label>
                            <div class="value-field">
                                @switch (entry.participation) {
                                    @case (Participation.OptIn) {
                                        Ja, hat zugestimmt
                                    }
                                    @case (Participation.OptOut) {
                                        Nein, ist ausgeschlossen
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <div class="active title">
                        <i class="dropdown icon right"></i>
                        Patient*innen-Informationen
                    </div>
                    <div class="active content">
                        <div class="field">
                            <label>Studien-ID (SIC)</label>
                            <div class="value-field">{{ entry.sic }}</div>
                        </div>

                        <div class="field">
                            <label>Einschlussdatum</label>
                            <div class="value-field">{{ entry.timestamp | momentDate:DateFormat.DATE }}</div>
                        </div>

                        <div class="field">
                            <label>Patient*innen-Referenz</label>
                            <div class="value-field">{{ entry.reference | patientReferenceToLabel }}</div>
                        </div>

                        <div class="field">
                            <label>{{ entry.reference | patientReferenceToLabel }}</label>
                            <div class="value">{{ entry.idExt }}</div>
                        </div>

                        <div class="field">
                            <patient-master-data [encounters]="encounters"
                                                 [masterData]="masterData"></patient-master-data>
                        </div>

                        <div class="field">
                            <label>Kommentar</label>
                            <textarea [(ngModel)]="entry.comment"
                                      name="comment"
                                      rows="4">
                                </textarea>
                        </div>
                    </div>

                    <div class="title">
                        <i class="dropdown icon right"></i>
                        Technische Informationen
                    </div>

                    <div class="content">
                        <div class="field">
                            <label>Root</label>
                            <div class="value-field">{{ entry.idRoot }}</div>
                        </div>
                        <div class="field">
                            <label>Registriert von</label>
                            <div class="value-field">{{ entry.user }}</div>
                        </div>
                        <div class="field">
                            <label>Registriert am</label>
                            <div class="value-field">{{ entry.timestamp | momentDate:DateFormat.DATE }}</div>
                        </div>
                        <div class="field">
                            <label>Studien-ID</label>
                            <div class="value-field">{{ entry.study.id }}</div>
                        </div>
                        <div class="field">
                            <label>Studientitel</label>
                            <div class="value-field">{{ entry.study.title }}</div>
                        </div>
                        <div class="field">
                            <label>Studienbeschreibung</label>
                            <div class="value-field">{{ entry.study.description }}</div>
                        </div>
                        <div class="field">
                            <label>Studie erstellt am</label>
                            <div class="value-field">{{ entry.study.createdTimestamp | momentDate:DateFormat.DATE }}</div>
                        </div>
                        <div class="field">
                            <label>Studie beendet am</label>
                            <div class="value-field">{{ entry.study.closedTimestamp | momentDate:DateFormat.DATE }}</div>
                        </div>
                        <div class="field">
                            <label>SIC Generator</label>
                            <div class="value-field">{{ entry.study.sicGenerator }}</div>
                        </div>
                        <div class="field">
                            <label>SIC State</label>
                            <div class="value-field">{{ entry.study.sicGeneratorState }}</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="actions">
                <button (click)="close()"
                        class="ui red button"
                        type="button">
                    Abbrechen
                </button>
                <button (click)="popUpMessageComponent.show = true"
                        class="ui button"
                        type="button">
                    Löschen
                </button>
                <button (click)="save()"
                        class="ui green button"
                        type="button">
                    Speichern
                </button>
            </div>
        </form>
    </div>
</div>

<popup-message #popUpMessageComponent
               (onClose)="delete($event)"
               head="Eitnrag löschen"
               message="Möchten Sie den Eintrag löschen?"
               mode="confirm">
</popup-message>
